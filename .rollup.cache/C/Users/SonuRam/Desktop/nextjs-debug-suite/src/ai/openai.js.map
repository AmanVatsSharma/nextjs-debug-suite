{"version":3,"file":"openai.js","sourceRoot":"","sources":["openai.ts"],"names":[],"mappings":"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","sourcesContent":["import type { AIService, AIAnalysisRequest, AIAnalysisResponse } from './types';\n\nexport class OpenAIService implements AIService {\n  private apiKey: string;\n  private baseUrl = 'https://api.openai.com/v1';\n  private model = 'gpt-4-turbo-preview';\n\n  constructor(apiKey: string) {\n    this.apiKey = apiKey;\n  }\n\n  private async makeRequest(endpoint: string, body: any) {\n    const response = await fetch(`${this.baseUrl}${endpoint}`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${this.apiKey}`,\n      },\n      body: JSON.stringify(body),\n    });\n\n    if (!response.ok) {\n      throw new Error(`OpenAI API error: ${response.statusText}`);\n    }\n\n    return response.json();\n  }\n\n  private createPrompt(request: AIAnalysisRequest): string {\n    switch (request.type) {\n      case 'error':\n        return `Analyze this error and provide a solution:\nError Type: ${request.context.error?.type}\nLocation: ${request.context.error?.location.file}:${request.context.error?.location.line}\nCode:\n${request.context.error?.visual.codePreview}`;\n\n      case 'performance':\n        return `Analyze these performance metrics and suggest improvements:\nMemory: ${JSON.stringify(request.context.metrics?.memory)}\nPerformance: ${JSON.stringify(request.context.metrics?.performance)}`;\n\n      case 'network':\n        return `Analyze this network activity and suggest optimizations:\n${request.context.codeContext}`;\n\n      case 'general':\n        return request.context.query || '';\n    }\n  }\n\n  async analyze(request: AIAnalysisRequest): Promise<AIAnalysisResponse> {\n    const prompt = this.createPrompt(request);\n    \n    const completion = await this.makeRequest('/chat/completions', {\n      model: this.model,\n      messages: [\n        {\n          role: 'system',\n          content: 'You are an expert developer assistant analyzing Next.js application issues.',\n        },\n        {\n          role: 'user',\n          content: prompt,\n        },\n      ],\n      temperature: 0.7,\n    });\n\n    const response = completion.choices[0].message.content;\n    \n    // Parse the response into structured format\n    // This is a simple implementation; you might want to make it more robust\n    const [explanation, ...rest] = response.split('\\n\\n');\n    const suggestedFix = rest.find(part => part.startsWith('```'))?.replace(/```\\w*\\n/, '').replace(/```$/, '');\n    \n    return {\n      explanation,\n      suggestedFix,\n      confidence: 0.8, // You might want to calculate this based on the model's response\n      relevantDocs: [],\n      similarIssues: [],\n    };\n  }\n\n  async generateDocs(context: string): Promise<string> {\n    const completion = await this.makeRequest('/chat/completions', {\n      model: this.model,\n      messages: [\n        {\n          role: 'system',\n          content: 'You are an expert technical writer creating documentation for Next.js applications.',\n        },\n        {\n          role: 'user',\n          content: `Generate documentation for this code:\\n${context}`,\n        },\n      ],\n      temperature: 0.5,\n    });\n\n    return completion.choices[0].message.content;\n  }\n\n  async predictIssue(metrics: Record<string, any>): Promise<{\n    prediction: string;\n    confidence: number;\n    suggestedAction?: string;\n  }> {\n    const completion = await this.makeRequest('/chat/completions', {\n      model: this.model,\n      messages: [\n        {\n          role: 'system',\n          content: 'You are an expert system analyzing performance metrics to predict potential issues.',\n        },\n        {\n          role: 'user',\n          content: `Analyze these metrics and predict potential issues:\\n${JSON.stringify(metrics, null, 2)}`,\n        },\n      ],\n      temperature: 0.3,\n    });\n\n    const response = completion.choices[0].message.content;\n    const [prediction, action] = response.split('\\n\\n');\n\n    return {\n      prediction,\n      confidence: 0.7,\n      suggestedAction: action,\n    };\n  }\n} "]}